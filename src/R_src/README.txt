----------------------------------------------------------------
SUBDIRECTORY R_src
----------------------------------------------------------------

This directory contains tools for post processing results 
generated by the core modules of informME. This directory 
contains the following files:

jsDMR.R
-------

This is an R script that performs DMR detection using 
the Jensen-Shannon distance (JSD) based on the method 
described in [1]. Once DMR detection is done, the script
generates helpful annotation tables and figures. It should 
be run within an R session.

  syntax (replicate reference data is available): 
 
   source("jsDMR.R") 
   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder,
   correction='XX',pAdjThresh=value) 
     
   # refVrefFiles is a vector of BIGWIG file names that contain  
   # the JSD values of all pairwise reference comparisons. 
   # For example: if 
   #
   # JSD-lungnormal-1-VS-lungnormal-2.bw
   # JSD-lungnormal-3-VS-lungnormal-1.bw 
   # JSD-lungnormal-3-VS-lungnormal-2.bw 
   #
   # are available, then set
   #
   # file1 <- "JSD-lungnormal-1-VS-lungnormal-2.bw"
   # file2 <- "JSD-lungnormal-3-VS-lungnormal-1.bw"
   # file3 <- "JSD-lungnormal-3-VS-lungnormal-2.bw"
   # refVrefFiles <- c(file1,file2,file3)
   #
   # testVrefFiles is a vector of BIGWIG file names that contain 
   # the JSD values of test/reference comparisons.
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bw
   # JSD-lungcancer-2-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-3.bw 
   #
   # are available, then set
   #
   # file4 <- "JSD-lungcancer-1-VS-lungnormal-1.bw"
   # file5 <- "JSD-lungcancer-2-VS-lungnormal-2.bw"
   # file6 <- "JSD-lungcancer-3-VS-lungnormal-3.bw"
   # testVrefFiles <- c(file4,file5,file6)
   #
   # inFolder is the directory that contains all JSD files
   # outFolder is the directory used to write the results
   #
   # For example:
   # inFolder <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # correction is an optional argument that specifies the 
   # type of multiple hypothesis correction used:
   #
   # BY: Benjamini & Yekutieli (default).
   # BH: Benjamini & Hochberg
   # 
   # pAdjThresh is an optional argument that specifies the 
   # adjusted p-value threshold used (0.01 by default). 
   #
   # Examples: 
   #
   # Default usage: BY applied with FDR control at 0.01.
   #   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder)
   # 
   # Alternative usage: BY applied with FDR control at 0.05.
   #   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder,
   #                   pAdjThresh=0.05)
   #
   # Alternative usage: BH applied with FDR control at 0.05.
   #   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder,
   #		       correction='BH',pAdjThresh=0.05)

  syntax (no replicate reference data is available) 
   
   source("jsDMR.R") 
   runNoReplicateDMR(JSDfile,inFolder,outFolder,
                     correction='XX',pAdjThresh=value)

   # JSDfile is the name of a BIGWIG file that contains 
   # the JSD values of a test/reference comparison. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bw
   #
   # is available, then set
   #
   # JSDfile <- "JSD-lungcancer-1-VS-lungnormal-1.bw"
   #
   # inFolder is the directory that contains the JSD file
   # outFolder is the directory used to write the result
   #
   # For example:
   # inFolder <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # correction is an optional argument that specifies the 
   # type of multiple hypothesis correction used:
   #
   # BY: Benjamini & Yekutieli (default).
   # BH: Benjamini & Hochberg
   # 
   # pAdjThresh is an optional argument that specifies the 
   # adjusted p-value threshold used (0.01 by default). 
   #
   # Examples: 
   #
   # Default usage: BY applied with FDR control at 0.01.
   #   runNoReplicateDMR(JSDfile,inFolder,outFolder)
   # 
   # Alternative usage: BY applied with FDR control at 0.05.
   #   runNoReplicateDMR(JSDfile,inFolder,outFolder,pAdjThresh=0.05)
   # 
   # Alternative usage: BH applied with FDR control at 0.05.
   #   runNoReplicateDMR(JSDfile,inFolder,outFolder,
   #		         correction='BH',pAdjThresh=0.05)

  requirements: 

   The following R libraries must be installed: 
     - rtracklayer
     - logitnorm
     - mixtools 
     - annotatr
     - Homo.Sapiens
     - ggplot2


jsGrank.R rankGenes function
----------------------------

This is an R function that ranks all Human genes in the 
Bioconductor library TxDb.Hsapiens.UCSC.hg19.knownGene using 
the average mutual information based on the method described 
in [2]. It should be run within an R session.

  default usage (replicate reference data is available):

   source("jsGrank.R")
   rankGenes(refVrefFiles,testVrefFiles,inFolder,outFolder,
             tName,rName)

   # refVrefFiles is a vector of BIGWIG files that contain the
   # JSD values of a test/reference comparison. 
   # For example: if
   #
   # JSD-lungnormal-1-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-1.bw 
   # JSD-lungnormal-3-VS-lungnormal-2.bw
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungnormal-1-VS-lungnormal-2.bw",
   #                    "JSD-lungnormal-3-VS-lungnormal-1.bw",
   #                    "JSD-lungnormal-3-VS-lungnormal-2.bw")
   #
   # testVrefFiles is a vector of BIGWIG files that contain the  
   # JSD values of available test/reference comparisons. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bw  
   # JSD-lungcancer-2-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-3.bw 
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungcancer-1-VS-lungnormal-1.bw",
   #                    "JSD-lungcancer-2-VS-lungnormal-2.bw",
   #                    "JSD-lungcancer-3-VS-lungnormal-3.bw")
   #
   # inFolder is the directory that contains the JSD files
   # outFolder is the directory used to write the result  
   # (a .tsv file).
   # 
   # For example:
   # 
   # inFolder  <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # tName and rName are strings providing names for the 
   # test and reference phenotypes.
   #
   # For example: 
   #
   # tName <- "lungcancer"
   # rName <- "lungnormal"

  default usage (no replicate reference data is available):  

   source("jsGrank.R")
   rankGenes(c(),testVrefFiles,inFolder,outFolder,
             tName,rName)

   # testVrefFiles is a vector of BIGWIG files that contain the  
   # JSD values of available test/reference comparisons. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bw 
   # JSD-lungcancer-2-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-3.bw 
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungcancer-1-VS-lungnormal-1.bw",
   #                    "JSD-lungcancer-2-VS-lungnormal-2.bw",
   #                    "JSD-lungcancer-3-VS-lungnormal-3.bw")
   #
   # inFolder is the directory that contains the JSD files
   # outFolder is the directory used to write the result 
   # (a .tsv file).
   # 
   # For example:
   # 
   # inFolder  <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # tName and rName are strings providing names for the 
   # test and reference phenotypes.
   #
   # For example: 
   #
   # tName <- "lungcancer"
   # rName <- "lungnormal"
   
  requirements:

   The following R libraries must be installed:
   - GenomicFeatures
   - GenomicRanges
   - Homo.sapiens
   - rtracklayer
   - TxDb.Hsapiens.UCSC.hg19.knownGene

jsGrank.R rankRegions function
----------------------------

This is an R function that ranks all regions in a BED file using 
the average mutual information based on the method described 
in [2]. It should be run within an R session.

  default usage (replicate reference data is available):

   source("jsGrank.R")
   rankRegions(refVrefFiles,testVrefFiles,regionsFile,regionsName,
               inFolder,outFolder,tName,rName)

   # refVrefFiles is a vector of BIGWIG files that contain the
   # JSD values of a test/reference comparison. 
   # For example: if
   #
   # JSD-lungnormal-1-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-1.bw 
   # JSD-lungnormal-3-VS-lungnormal-2.bw
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungnormal-1-VS-lungnormal-2.bw",
   #                    "JSD-lungnormal-3-VS-lungnormal-1.bw",
   #                    "JSD-lungnormal-3-VS-lungnormal-2.bw")
   #
   # testVrefFiles is a vector of BIGWIG files that contain the  
   # JSD values of available test/reference comparisons. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bw  
   # JSD-lungcancer-2-VS-lungnormal-2.bw 
   # JSD-lungcancer-3-VS-lungnormal-3.bw 
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungcancer-1-VS-lungnormal-1.bw",
   #                    "JSD-lungcancer-2-VS-lungnormal-2.bw",
   #                    "JSD-lungcancer-3-VS-lungnormal-3.bw")
   #
   # regionsFile is a string containing the name of the bed file
   # with regions that you want ranked. 
   # For example: if you have the following file with regions
   #
   # bivalentDomains.bed
   #
   # then set
   #
   # regionsFile <- "bivalentDomains.bed"
   #
   # regionsName is a short string used to nickname the regions.
   # For example with the above file you might set:
   # 
   # regionsName <- "bivDom"
   #
   # inFolder is the directory that contains the JSD files
   # and the regionsFile
   #
   # outFolder is the directory used to write the result  
   # (a .tsv file).
   # 
   # For example:
   # 
   # inFolder  <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # tName and rName are strings providing names for the 
   # test and reference phenotypes.
   #
   # For example: 
   #
   # tName <- "lungcancer"
   # rName <- "lungnormal"


REFERENCES
----------

[1] Jenkninson, G., Abante, J., Feinberg, A.P., and 
    Goutsias, J. (2018). An information-theoretic approach 
    to the modeling and analysis of whole-genome bisulfite 
    sequencing data, BMC Bioinformatics, 19:87, 
    https://doi.org/10.1186/s12859-018-2086-5.

[2] Jenkinson, G., Abante, J., Koldobskiy, M., Feinberg, A.P., 
    and Goutsias, J. (2019). Ranking genomic features using 
    an information-theoretic measure of epigenetic discordance, 
    BMC Bioinformatics (Accepted).
