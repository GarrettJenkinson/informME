Last Modified: 07/26/17

----------------------------------------------------------------
SUBDIRECTORY PostProcess
----------------------------------------------------------------

This directory contains tools for post processing results 
generated by the core modules of informME. This directory 
contains the following files:

bed2bw.sh
---------

This is a BASH script that converts BED files to BigWig files.

  usage: 

   ./bed2bw.sh "/path/to/directory/containing/BED/files/" "asy" 
   
   for the assembly "asy" of the reference genome used to 
   generate the BED files (for example, "asy" must be set 
   to "hg19" when the Human assembly hg19 is used). 
  
  output:

   The resulting BigWig files are placed within 
   /path/to/directory/containing/BED/files/BWfiles.

  requirements: 

   The following tools must be installed on $PATH: 
   bedtools, bedClip, bedGraphToBigWig, and 
   fetchChromSizes.

jsDMR.R
-------

This is an R script that performs DMR detection using 
the Jensen-Shannon distance (JSD) based on the method 
described in [1]. It should be run within an R session.

  default usage (replicate reference data is available): 
 
   setwd("/path/to/informME/PostProcess/")
   source("jsDMR.R") 
   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder)
     
   # refVrefFiles is a vector of BED file names that contain  
   # the JSD values of all pairwise reference comparisons. 
   # For example: if 
   #
   # JSD-lungnormal-1-VS-lungnormal-2.bed
   # JSD-lungnormal-3-VS-lungnormal-1.bed 
   # JSD-lungnormal-3-VS-lungnormal-2.bed 
   #
   # are available, then set
   #
   # file1 <- "JSD-lungnormal-1-VS-lungnormal-2.bed"
   # file2 <- "JSD-lungnormal-3-VS-lungnormal-1.bed"
   # file3 <- "JSD-lungnormal-3-VS-lungnormal-2.bed"
   # refVrefFiles <- c(file1,file2,file3)
   #
   # testVrefFiles is a vector of BED file names that contain  
   # the JSD values of test/reference comparisons.
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bed
   # JSD-lungcancer-2-VS-lungnormal-2.bed 
   # JSD-lungcancer-3-VS-lungnormal-3.bed 
   #
   # are available, then set
   #
   # file4 <- "JSD-lungcancer-1-VS-lungnormal-1.bed"
   # file5 <- "JSD-lungcancer-2-VS-lungnormal-2.bed"
   # file6 <- "JSD-lungcancer-3-VS-lungnormal-3.bed"
   # testVrefFiles <- c(file4,file5,file6)
   #
   # inFolder is the directory that contains all JSD files
   # outFolder is the directory used to write the results
   #
   # For example:
   # inFolder <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # Examples: 
   #
   # Default usage: Benjamini & Yekutieli applied with FDR control under 0.01.
   #   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder)
   # 
   # Another usage: Benjamini & Hochberg applied with FDR control under 0.05.
   #   runReplicateDMR(refVrefFiles,testVrefFiles,inFolder,outFolder,
   #                   correction='BH',pAdjThresh=0.05)

  default usage (no replicate reference data is available) 
   
   setwd("/path/to/informME/PostProcess/")
   source("jsDMR.R") 
   runNoReplicateDMR(JSDfile,inFolder,outFolder)

   # JSDfile is the name of a BED file that contains 
   # the JSD values of a test/reference comparison. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bed
   #
   # is available, then set
   #
   # JSDfile <- "JSD-lungcancer-1-VS-lungnormal-1.bed"
   #
   # inFolder is the directory that contains the JSD file
   # outFolder is the directory used to write the result
   #
   # For example:
   # inFolder <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # Examples: 
   #
   # Default usage: Benjamini & Yekutieli applied with FDR control under 0.01.
   #   runNoReplicateDMR(JSDfile,inFolder,outFolder)
   # 
   # Another usage: Benjamini & Hochberg applied with FDR control under 0.05.
   #   runNoReplicateDMR(JSDfile,inFolder,outFolder,correction='BH',pAdjThresh=0.05)

  requirements: 

   The following R libraries must be installed: 
     - rtracklayer
     - logitnorm
     - mixtools 


jsGrank.R
---------

This is an R script that ranks all Human genes in the 
Bioconductor library TxDb.Hsapiens.UCSC.hg19.knownGene using 
the Jensen-Shannon distance (JSD) based on the method described 
in [1]. It should be run within an R session.

  default usage (replicate reference data is available):

   setwd("path/to/informME/PostProcess/")
   source("jsGrank.R")
   rankGenes(refVrefFiles,testVrefFiles,inFolder,outFolder,
             tName,rName)

   # refVrefFiles is a vector of BED files that contain the
   # JSD values of a test/reference comparison. 
   # For example: if
   #
   # JSD-lungnormal-1-VS-lungnormal-2.bed 
   # JSD-lungcancer-3-VS-lungnormal-1.bed 
   # JSD-lungnormal-3-VS-lungnormal-2.bed
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungnormal-1-VS-lungnormal-2.bed",
   #                    "JSD-lungnormal-3-VS-lungnormal-1.bed",
   #                    "JSD-lungnormal-3-VS-lungnormal-2.bed")
   #
   # testVrefFiles is a vector of BED files that contain the  
   # JSD values of available test/reference comparisons. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bed  
   # JSD-lungcancer-2-VS-lungnormal-2.bed 
   # JSD-lungcancer-3-VS-lungnormal-3.bed 
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungcancer-1-VS-lungnormal-1.bed",
   #                    "JSD-lungcancer-2-VS-lungnormal-2.bed",
   #                    "JSD-lungcancer-3-VS-lungnormal-3.bed")
   #
   # inFolder is the directory that contains the JSD files
   # outFolder is the directory used to write the result  
   # (a .xlsx file).
   # 
   # For example:
   # 
   # inFolder  <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # tName and rName are strings providing names for the 
   # test and reference phenotypes.
   #
   # For example: 
   #
   # tName <- "lungcancer"
   # rName <- "lungnormal"

  default usage (no replicate reference data is available):  

   setwd("path/to/informME/PostProcess/")
   source("jsGrank.R")
   rankGenes(c(),testVrefFiles,inFolder,outFolder,
             tName,rName)

   # testVrefFiles is a vector of BED files that contain the  
   # JSD values of available test/reference comparisons. 
   # For example: if 
   #
   # JSD-lungcancer-1-VS-lungnormal-1.bed 
   # JSD-lungcancer-2-VS-lungnormal-2.bed 
   # JSD-lungcancer-3-VS-lungnormal-3.bed 
   # 
   # are available, then set 
   # 
   # textVrefFiles <- c("JSD-lungcancer-1-VS-lungnormal-1.bed",
   #                    "JSD-lungcancer-2-VS-lungnormal-2.bed",
   #                    "JSD-lungcancer-3-VS-lungnormal-3.bed")
   #
   # inFolder is the directory that contains the JSD files
   # outFolder is the directory used to write the result 
   # (a .xlsx file).
   # 
   # For example:
   # 
   # inFolder  <- "/path/to/in-folder/"
   # outFolder <- "/path/to/out-folder/"
   #
   # tName and rName are strings providing names for the 
   # test and reference phenotypes.
   #
   # For example: 
   #
   # tName <- "lungcancer"
   # rName <- "lungnormal"
   
  requirements:

   The following R libraries must be installed:
   - GenomicFeatures
   - GenomicRanges
   - Homo.sapiens
   - rtracklayer
   - TxDb.Hsapiens.UCSC.hg19.knownGene
   - XLConnect


REFERENCES
----------

[1] Jenkninson, G., Feinberg, A.P., and Goutsias, J. (2017) 
    An informtaion-theoretic approach to the modeling and 
    analysis of whole-genome bisulfite sequencing data, 
    Submitted.






